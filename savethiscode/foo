searchIndex = 'metabuzz-search.json'
//https://stackoverflow.com/questions/7346563/loading-local-json-file
// https://stackoverflow.com/questions/48594581/asynchronous-callback-in-javascript

// https://stackoverflow.com/questions/7346563/loading-local-json-file
/*
function loadJSON(ex) {
  xobj = new XMLHttpRequest()
  xobj.addEventListener("load", reqListener)
  xobj.overrideMimeType("application/json")
  xobj.open('GET', searchIndex,true)
  alert('loadJSON(): xobj = ' + xobj)
  xobj.onreadystatechange = function() {
    if (xobj.readyState === 4 && xobj.status === 200) {
      ex(xobj.responseText)
    }
  };
  xobj.send(null)
  XmlHttpRequest.send(null)
}
*/

function loadJson(ex) {
  //alert('loadJson()')
  var XmlHttpRequest = new XMLHttpRequest();
  XmlHttpRequest.onreadystatechange = function () {
    //alert('onreadystatechange')
    if (XmlHttpRequest.readyState == 4 && XmlHttpRequest.status == "200") {
      // .open will NOT return a value 
      // but simply returns undefined in async mode so use a callback
      //alert('loadJson callback happening')
      document.getElementById("demo").innerHTML = XmlHttpRequest.name;
      //ex(XmlHttpRequest.responseText);
    }
  };
  XmlHttpRequest.overrideMimeType("application/json");
  XmlHttpRequest.open('GET', searchIndex, true);
  XmlHttpRequest.send(null);
  //alert('I hope it is: ' + XmlHttpRequest.response)
  alert(XmlHttpRequest.responseText)
  return (XmlHttpRequest.responseText)
}

/*
var callback = function(){
};
*/


function show(f) {
  alert(f)
 } 

function readTextFile(file, cb) {
    //alert('readTextFile() ' + file )
    var rawFile = new XMLHttpRequest();
    rawFile.overrideMimeType("application/json");
    rawFile.open("GET", file, true);
    rawFile.onreadystatechange = function() {
        if (rawFile.readyState == 4 && rawFile.status == "200") {
            document.getElementById("demo").innerHTML = rawFile.name;
            //cb(rawFile.responseText);
        }
    }
    rawFile.send(null);
}











old foo:

<!DOCTYPE html>
<html lang=en>
	<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width,initial-scale=1">
	
<title>metabuzz: Title needed here, squib</title>

<meta name="description" content=".">
<link rel="stylesheet" href="themes/search/reset.css">
<link rel="stylesheet" href="themes/search/fonts.css">
<link rel="stylesheet" href="themes/search/layout.css">
<link rel="stylesheet" href="themes/search/sizes.css">
<link rel="stylesheet" href="themes/search/theme-light.css">
<link rel="stylesheet" href="themes/search/search.css">
<link rel="stylesheet" href="themes/search/responsive.css">

</head>
<body>

<header><ul>
<li><a href="/">search</a></li>
<li><a href="/">Events</a></li>
<li><a href="/">Subscribe</a>
<span id="demo">x</span></li>
</ul>
<script>

searchIndex = 'metabuzz-search.json'
//https://stackoverflow.com/questions/7346563/loading-local-json-file
// https://stackoverflow.com/questions/48594581/asynchronous-callback-in-javascript

// https://stackoverflow.com/questions/7346563/loading-local-json-file
/*
function loadJSON(ex) {
  xobj = new XMLHttpRequest()
  xobj.addEventListener("load", reqListener)
  xobj.overrideMimeType("application/json")
  xobj.open('GET', searchIndex,true)
  alert('loadJSON(): xobj = ' + xobj)
  xobj.onreadystatechange = function() {
    if (xobj.readyState === 4 && xobj.status === 200) {
      ex(xobj.responseText)
    }
  };
  xobj.send(null)
  XmlHttpRequest.send(null)
}
*/

function loadJson(ex) {
  alert('loadJson()')
  var XmlHttpRequest = new XMLHttpRequest();
  XmlHttpRequest.onreadystatechange = function () {
    //alert('onreadystatechange')
    if (XmlHttpRequest.readyState == 4 && XmlHttpRequest.status == "200") {
      // .open will NOT return a value 
      // but simply returns undefined in async mode so use a callback
      //alert('loadJson callback happening')
      document.getElementById("demo").innerHTML = XmlHttpRequest.name;
      //ex(XmlHttpRequest.responseText);
    }
  };
  XmlHttpRequest.overrideMimeType("application/json");
  XmlHttpRequest.open('GET', searchIndex, true);
  XmlHttpRequest.send(null);
  alert(XmlHttpRequest.response)
  //alert(XmlHttpRequest.responseText)
  return (XmlHttpRequest.responseText)
}

/*
var callback = function(){
};
*/


function show(f) {
  alert(f)
 } 

function readTextFile(file, cb) {
    //alert('readTextFile() ' + file )
    var rawFile = new XMLHttpRequest();
    rawFile.overrideMimeType("application/json");
    rawFile.open("GET", file, true);
    rawFile.onreadystatechange = function() {
        if (rawFile.readyState == 4 && rawFile.status == "200") {
            alert('yo')
            document.getElementById("demo").innerHTML = rawFile.name;
            //cb(rawFile.responseText);
        }
    }
    rawFile.send(null);
}

function loadSearchIndex(){
  console.log('1')
  document.getElementById("demo").innerHTML = 'y';
  var xmlhttp = new XMLHttpRequest();
  xmlhttp.onreadystatechange = function() {
      console.log('this.readyState: ' + this.readyState + '. this.status: ' + this.status)
      if (this.readyState == 4 && this.status == 200) {
          alert('this.responseText is: ' + this.responseText)
          var myObj = JSON.parse(this.responseText);
          document.getElementById("demo").innerHTML = myObj.name;
      }
  };
  xmlhttp.open("GET", searchIndex, true);
  xmlhttp.send();
}




//usage:


function lsearch(){
  alert('Searching for: ' + document.searchForm.search.value);
  return false;
}

// Ensure document's loaded before running Javascript
if (
    document.readyState === "complete" ||
    (document.readyState !== "loading" && !document.documentElement.doScroll)
) {
  loadSearchIndex()
} else {

  document.addEventListener("DOMContentLoaded", loadSearchIndex);
}
</script>
<form name="searchForm" onSubmit="lsearch()"><input type="text" id="search" name="search"><span class='icn icn-find'> </span>
</form>
</header>

<nav><p><a href="/">Learn More</a> <a href="/">Download the App</a> <a href="/">Contact</a>  <a href="/">Media</a></p>
</nav>

<article></article>

<footer><table>
<thead>
<tr>
<th>SECTIONS</th>
<th>CONNECTIONS</th>
<th>About Us</th>
<th align="left">Your rights</th>
</tr>
</thead>
<tbody>
<tr>
<td><a href="/">Sitemap</a></td>
<td><a href="/">Twitter</a></td>
<td><a href="/">About</a></td>
<td align="left"><a href="/">Privacy and cookies</a></td>
</tr>
<tr>
<td><a href="/">Articles</a></td>
<td><a href="/">Instagram</a></td>
<td><a href="/">Credits</a></td>
<td align="left"><a href="/">Terms of use </a></td>
</tr>
<tr>
<td><a href="/">Tutorials</a></td>
<td><a href="/">LinkedIn</a></td>
<td><a href="/">Media</a></td>
<td align="left"><a href="/">About our ads</a></td>
</tr>
<tr>
<td><a href="/">Blog</a></td>
<td><a href="/">YouTube</a></td>
<td></td>
<td align="left"></td>
</tr>
<tr>
<td><a href="/">Opinion</a></td>
<td><a href="/">Instagram</a></td>
<td></td>
<td align="left"></td>
</tr>
<tr>
<td><a href="/">Sitemap</a></td>
<td><a href="/">Twitter</a></td>
<td></td>
<td align="left"></td>
</tr>
<tr>
<td></td>
<td><a href="/">LinkedIn</a></td>
<td></td>
<td align="left"></td>
</tr>
<tr>
<td></td>
<td><a href="/">Podcast</a></td>
<td></td>
<td align="left"></td>
</tr>
<tr>
<td></td>
<td><a href="/">RSS</a></td>
<td></td>
<td align="left"></td>
</tr>
</tbody>
</table>
</footer>

</body>
</html>
